<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Các level isolation của transaction trong SQL | Thanh HV's Blog</title>
<meta name=keywords content="database,transaction isolation"><meta name=description content="Thời gian gần đây khi mình tham gia các buổi phỏng vấn ở vị trí backend thì thường xuyên được hỏi đến các câu hỏi về database, trong đó chủ yếu xoay quanh transaction.
Vậy nên trong bài viết hôm nay mình sẽ cùng ôn lại kiến thức về nó nhé.
Nội dung này mình không rành lắm nên chủ yếu là góp nhặt và tích luỹ để viết cho bản thân nhớ lâu hơn — cũng tiện chia sẻ cho các bạn hữu duyên nếu đọc được."><meta name=author content><link rel=canonical href=https://thanhhv.github.io/posts/transaction-isolation-level/><link crossorigin=anonymous href=/assets/css/stylesheet.36ab24e4c1b924360adfc391166b0e8914323d9d6ffa42a50f9c6c435c5e1831.css integrity="sha256-Nqsk5MG5JDYK38ORFmsOiRQyPZ1v+kKlD5xsQ1xeGDE=" rel="preload stylesheet" as=style><link rel=icon href=https://thanhhv.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://thanhhv.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://thanhhv.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://thanhhv.github.io/apple-touch-icon.png><link rel=mask-icon href=https://thanhhv.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://thanhhv.github.io/posts/transaction-isolation-level/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://thanhhv.github.io/posts/transaction-isolation-level/"><meta property="og:site_name" content="Thanh HV's Blog"><meta property="og:title" content="Các level isolation của transaction trong SQL"><meta property="og:description" content="Thời gian gần đây khi mình tham gia các buổi phỏng vấn ở vị trí backend thì thường xuyên được hỏi đến các câu hỏi về database, trong đó chủ yếu xoay quanh transaction.
Vậy nên trong bài viết hôm nay mình sẽ cùng ôn lại kiến thức về nó nhé.
Nội dung này mình không rành lắm nên chủ yếu là góp nhặt và tích luỹ để viết cho bản thân nhớ lâu hơn — cũng tiện chia sẻ cho các bạn hữu duyên nếu đọc được."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-10-08T20:10:00+07:00"><meta property="article:modified_time" content="2025-10-08T20:10:00+07:00"><meta property="article:tag" content="Database"><meta property="article:tag" content="Transaction Isolation"><meta name=twitter:card content="summary"><meta name=twitter:title content="Các level isolation của transaction trong SQL"><meta name=twitter:description content="Thời gian gần đây khi mình tham gia các buổi phỏng vấn ở vị trí backend thì thường xuyên được hỏi đến các câu hỏi về database, trong đó chủ yếu xoay quanh transaction.
Vậy nên trong bài viết hôm nay mình sẽ cùng ôn lại kiến thức về nó nhé.
Nội dung này mình không rành lắm nên chủ yếu là góp nhặt và tích luỹ để viết cho bản thân nhớ lâu hơn — cũng tiện chia sẻ cho các bạn hữu duyên nếu đọc được."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://thanhhv.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Các level isolation của transaction trong SQL","item":"https://thanhhv.github.io/posts/transaction-isolation-level/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Các level isolation của transaction trong SQL","name":"Các level isolation của transaction trong SQL","description":"Thời gian gần đây khi mình tham gia các buổi phỏng vấn ở vị trí backend thì thường xuyên được hỏi đến các câu hỏi về database, trong đó chủ yếu xoay quanh transaction.\nVậy nên trong bài viết hôm nay mình sẽ cùng ôn lại kiến thức về nó nhé.\nNội dung này mình không rành lắm nên chủ yếu là góp nhặt và tích luỹ để viết cho bản thân nhớ lâu hơn — cũng tiện chia sẻ cho các bạn hữu duyên nếu đọc được.\n","keywords":["database","transaction isolation"],"articleBody":"Thời gian gần đây khi mình tham gia các buổi phỏng vấn ở vị trí backend thì thường xuyên được hỏi đến các câu hỏi về database, trong đó chủ yếu xoay quanh transaction.\nVậy nên trong bài viết hôm nay mình sẽ cùng ôn lại kiến thức về nó nhé.\nNội dung này mình không rành lắm nên chủ yếu là góp nhặt và tích luỹ để viết cho bản thân nhớ lâu hơn — cũng tiện chia sẻ cho các bạn hữu duyên nếu đọc được.\nCùng nhau bắt đầu nhé 👇\n🧩 Mở bài Khi nói đến transaction trong SQL, chúng ta thường nghe đến khái niệm ACID — 4 tính chất quan trọng đảm bảo một transaction hoạt động an toàn và nhất quán.\n🔹 Atomicity (Tính nguyên tử) Mọi thao tác trong transaction được xem là một khối duy nhất.\nHoặc tất cả đều thực hiện thành công, hoặc không có gì được thực hiện (rollback).\n➡️ Ví dụ:\nChuyển tiền từ A → B gồm 2 bước:\nTrừ tiền tài khoản A Cộng tiền tài khoản B Nếu bước 2 lỗi → bước 1 phải rollback, để không mất tiền oan.\n🔹 Consistency (Tính nhất quán) Sau mỗi transaction, dữ liệu phải giữ được trạng thái hợp lệ theo các ràng buộc (constraint, foreign key, trigger,…).\n➡️ Ví dụ:\nTổng tiền của A + B phải luôn bằng 1000 trước và sau giao dịch — không thể thành 900 hay 1100.\n🔹 Isolation (Tính cô lập) Nhiều transaction chạy song song không được ảnh hưởng lẫn nhau.\nKết quả cuối cùng phải giống như khi chúng được thực thi tuần tự.\n🔹 Durability (Tính bền vững) Khi transaction đã commit, dữ liệu được ghi vĩnh viễn (thường là xuống đĩa hoặc WAL log).\nKể cả khi hệ thống crash, dữ liệu vẫn không mất.\n💡 ACID = đảm bảo giao dịch toàn vẹn, nhất quán, độc lập và bền vững.\n⚙️ Thân bài: Isolation Level trong SQL Hầu hết các hệ quản trị cơ sở dữ liệu quan hệ đều hỗ trợ 4 mức độ isolation.\nCùng xem chi tiết nhé 👇\n🧱 1. Read Uncommitted Transaction có thể đọc dữ liệu chưa commit từ transaction khác.\n➡️ Dễ xảy ra dirty read (đọc dữ liệu “bẩn”, sai).\nVí dụ:\nTransaction A cập nhật balance = 500 nhưng chưa commit. Transaction B đọc thấy balance = 500. Sau đó A rollback → dữ liệu B đọc là sai. ⚠️ Ít dùng, không an toàn.\nPostgreSQL không thực sự hỗ trợ mức này — nó tự động nâng lên Read Committed.\n🧱 2. Read Committed (mặc định trong PostgreSQL, Oracle) Chỉ đọc dữ liệu đã commit.\nMỗi query chỉ thấy dữ liệu đã commit trước khi query bắt đầu.\nCó thể xảy ra:\nNon-repeatable read (đọc cùng dòng hai lần, thấy giá trị khác). Phantom read (các dòng mới được thêm xuất hiện trong lần đọc sau). Ví dụ:\nA đọc balance = 1000. B update → commit → A đọc lại thấy balance = 800. 🧱 3. Repeatable Read (mặc định trong MySQL) Toàn bộ transaction sẽ thấy một snapshot dữ liệu tại thời điểm transaction bắt đầu.\nNgăn dirty read và non-repeatable read,\nnhưng vẫn có thể xảy ra phantom read (dòng mới được insert sau khi snapshot chụp).\nVí dụ:\nA đếm COUNT(*) user = 5. B thêm 1 user mới → commit → A vẫn thấy = 5 (snapshot cũ). Nhưng nếu A thêm dữ liệu tương tự có thể bị conflict (phantom). Trong cùng 1 transaction (Repeatable Read / Serializable), dữ liệu bị “đóng băng” theo snapshot tại lúc bắt đầu transaction.\nKhi mở transaction mới, snapshot mới sẽ được tạo → query sẽ thấy bản ghi mới commit từ transaction khác.\n🧱 4. Serializable Mức mạnh nhất — đảm bảo kết quả tương đương như thể các transaction chạy tuần tự.\nNgăn tất cả anomaly (dirty, non-repeatable, phantom).\nDatabase sẽ phát hiện conflict và rollback 1 transaction (serialization failure).\nVí dụ:\n-- Transaction A SELECT SUM(balance) FROM accounts; -- thấy tổng = 1000 -- Transaction B UPDATE accounts SET balance = balance - 100 WHERE id = 1; COMMIT; -- Transaction A (tiếp tục) UPDATE accounts SET balance = balance + 100 WHERE id = 2; COMMIT; Nếu để nguyên (Read Committed / Repeatable Read), về mặt lý thuyết có thể tổng số dư bị sai lệch.\nVới Serializable, PostgreSQL sẽ rollback một trong hai transaction → đảm bảo kết quả giống như thể chúng chạy tuần tự (A trước B hoặc B trước A).\n🧾 Ứng dụng thực tế: Đặt vé / Booking Giả sử có 1 ghế duy nhất.\nTransaction A kiểm tra ghế trống → insert booking. Transaction B cũng kiểm tra và thấy trống (do snapshot giống nhau) → insert booking. → Với Read Committed / Repeatable Read, có thể 2 booking cùng tồn tại.\n→ Với Serializable, PostgreSQL rollback 1 booking → đảm bảo ghế chỉ được đặt 1 lần.\n🍃 Isolation trong MongoDB MongoDB không có nhiều isolation level như SQL.\nNó chỉ có một mức duy nhất cho transaction: Snapshot Isolation (SI) — tương tự Repeatable Read trong PostgreSQL.\nNghĩa là:\nTransaction đọc dữ liệu nhất quán theo snapshot tại thời điểm bắt đầu. Không thấy dữ liệu chưa commit từ transaction khác (no dirty read). Các query trong cùng transaction thấy cùng một snapshot (no non-repeatable read). Tuy nhiên, vẫn có thể gặp write conflict (phantom/write skew) → MongoDB sẽ rollback 1 transaction. ✅ Kết luận Việc lựa chọn isolation level cho transaction phụ thuộc vào mục đích và yêu cầu của hệ thống. Ở mức càng cao, ứng dụng sẽ an toàn và nhất quán hơn, nhưng đồng thời hiệu năng có thể giảm do tốn thêm chi phí kiểm tra và khóa dữ liệu.\nCảm ơn bạn đã đọc đến đây! Nếu bạn có kinh nghiệm hoặc góc nhìn khác về chủ đề này, đừng ngần ngại chia sẻ ở phần bình luận bên dưới nhé.\nSee ya 👋\n","wordCount":"1010","inLanguage":"en","datePublished":"2025-10-08T20:10:00+07:00","dateModified":"2025-10-08T20:10:00+07:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://thanhhv.github.io/posts/transaction-isolation-level/"},"publisher":{"@type":"Organization","name":"Thanh HV's Blog","logo":{"@type":"ImageObject","url":"https://thanhhv.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://thanhhv.github.io/ accesskey=h title="Thanh HV's Blog (Alt + H)">Thanh HV's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://thanhhv.github.io/ title=Home><span>Home</span></a></li><li><a href=https://thanhhv.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://thanhhv.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://thanhhv.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://thanhhv.github.io/about-me/ title="About me"><span>About me</span></a></li><li><a href=https://thanhhv.github.io/wiki/ title=Wiki><span>Wiki</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://thanhhv.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://thanhhv.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Các level isolation của transaction trong SQL</h1><div class=post-meta><span title='2025-10-08 20:10:00 +0700 +07'>October 8, 2025</span>&nbsp;·&nbsp;5 min</div></header><div class=post-content><p>Thời gian gần đây khi mình tham gia các buổi phỏng vấn ở vị trí backend thì thường xuyên được hỏi đến các câu hỏi về <strong>database</strong>, trong đó chủ yếu xoay quanh <strong>transaction</strong>.<br>Vậy nên trong bài viết hôm nay mình sẽ cùng ôn lại kiến thức về nó nhé.<br>Nội dung này mình không rành lắm nên chủ yếu là góp nhặt và tích luỹ để viết cho bản thân nhớ lâu hơn — cũng tiện chia sẻ cho các bạn hữu duyên nếu đọc được.</p><p>Cùng nhau bắt đầu nhé 👇</p><p><img alt="isolation level" loading=lazy src=/posts/transaction-isolation-level/isolation-level.png></p><hr><h2 id=-mở-bài>🧩 Mở bài<a hidden class=anchor aria-hidden=true href=#-mở-bài>#</a></h2><p>Khi nói đến <strong>transaction trong SQL</strong>, chúng ta thường nghe đến khái niệm <strong>ACID</strong> — 4 tính chất quan trọng đảm bảo một transaction hoạt động <strong>an toàn và nhất quán</strong>.</p><h3 id=-atomicity-tính-nguyên-tử>🔹 Atomicity (Tính nguyên tử)<a hidden class=anchor aria-hidden=true href=#-atomicity-tính-nguyên-tử>#</a></h3><p>Mọi thao tác trong transaction được xem là một khối duy nhất.<br>Hoặc tất cả đều thực hiện thành công, hoặc <strong>không có gì được thực hiện (rollback)</strong>.</p><p>➡️ <strong>Ví dụ:</strong><br>Chuyển tiền từ A → B gồm 2 bước:</p><ol><li>Trừ tiền tài khoản A</li><li>Cộng tiền tài khoản B</li></ol><p>Nếu bước 2 lỗi → bước 1 phải rollback, để không mất tiền oan.</p><hr><h3 id=-consistency-tính-nhất-quán>🔹 Consistency (Tính nhất quán)<a hidden class=anchor aria-hidden=true href=#-consistency-tính-nhất-quán>#</a></h3><p>Sau mỗi transaction, dữ liệu phải giữ được trạng thái hợp lệ theo các ràng buộc (constraint, foreign key, trigger,…).</p><p>➡️ <strong>Ví dụ:</strong><br>Tổng tiền của A + B phải luôn bằng 1000 trước và sau giao dịch — không thể thành 900 hay 1100.</p><hr><h3 id=-isolation-tính-cô-lập>🔹 Isolation (Tính cô lập)<a hidden class=anchor aria-hidden=true href=#-isolation-tính-cô-lập>#</a></h3><p>Nhiều transaction chạy song song <strong>không được ảnh hưởng lẫn nhau</strong>.<br>Kết quả cuối cùng phải giống như khi chúng được thực thi tuần tự.</p><hr><h3 id=-durability-tính-bền-vững>🔹 Durability (Tính bền vững)<a hidden class=anchor aria-hidden=true href=#-durability-tính-bền-vững>#</a></h3><p>Khi transaction đã <strong>commit</strong>, dữ liệu được ghi vĩnh viễn (thường là xuống đĩa hoặc WAL log).<br>Kể cả khi hệ thống crash, dữ liệu vẫn không mất.</p><blockquote><p>💡 <strong>ACID</strong> = đảm bảo giao dịch toàn vẹn, nhất quán, độc lập và bền vững.</p></blockquote><hr><h2 id=-thân-bài-isolation-level-trong-sql>⚙️ Thân bài: Isolation Level trong SQL<a hidden class=anchor aria-hidden=true href=#-thân-bài-isolation-level-trong-sql>#</a></h2><p>Hầu hết các hệ quản trị cơ sở dữ liệu quan hệ đều hỗ trợ <strong>4 mức độ isolation</strong>.<br>Cùng xem chi tiết nhé 👇</p><hr><h3 id=-1-read-uncommitted>🧱 1. Read Uncommitted<a hidden class=anchor aria-hidden=true href=#-1-read-uncommitted>#</a></h3><p>Transaction có thể <strong>đọc dữ liệu chưa commit</strong> từ transaction khác.<br>➡️ Dễ xảy ra <strong>dirty read</strong> (đọc dữ liệu “bẩn”, sai).</p><p><strong>Ví dụ:</strong></p><ul><li>Transaction A cập nhật <code>balance = 500</code> nhưng chưa commit.</li><li>Transaction B đọc thấy <code>balance = 500</code>.</li><li>Sau đó A rollback → dữ liệu B đọc là sai.</li></ul><blockquote><p>⚠️ Ít dùng, không an toàn.<br>PostgreSQL không thực sự hỗ trợ mức này — nó tự động nâng lên <strong>Read Committed</strong>.</p></blockquote><hr><h3 id=-2-read-committed-mặc-định-trong-postgresql-oracle>🧱 2. Read Committed <em>(mặc định trong PostgreSQL, Oracle)</em><a hidden class=anchor aria-hidden=true href=#-2-read-committed-mặc-định-trong-postgresql-oracle>#</a></h3><p>Chỉ đọc <strong>dữ liệu đã commit</strong>.<br>Mỗi query chỉ thấy dữ liệu đã commit <strong>trước khi query bắt đầu</strong>.</p><p>Có thể xảy ra:</p><ul><li><strong>Non-repeatable read</strong> (đọc cùng dòng hai lần, thấy giá trị khác).</li><li><strong>Phantom read</strong> (các dòng mới được thêm xuất hiện trong lần đọc sau).</li></ul><p><strong>Ví dụ:</strong></p><ul><li>A đọc <code>balance = 1000</code>.</li><li>B update → commit → A đọc lại thấy <code>balance = 800</code>.</li></ul><hr><h3 id=-3-repeatable-read-mặc-định-trong-mysql>🧱 3. Repeatable Read <em>(mặc định trong MySQL)</em><a hidden class=anchor aria-hidden=true href=#-3-repeatable-read-mặc-định-trong-mysql>#</a></h3><p>Toàn bộ transaction sẽ thấy <strong>một snapshot dữ liệu tại thời điểm transaction bắt đầu</strong>.<br>Ngăn <strong>dirty read</strong> và <strong>non-repeatable read</strong>,<br>nhưng vẫn có thể xảy ra <strong>phantom read</strong> (dòng mới được insert sau khi snapshot chụp).</p><p><strong>Ví dụ:</strong></p><ul><li>A đếm <code>COUNT(*) user = 5</code>.</li><li>B thêm 1 user mới → commit → A vẫn thấy = 5 (snapshot cũ).</li><li>Nhưng nếu A thêm dữ liệu tương tự có thể bị conflict (phantom).</li></ul><blockquote><p>Trong cùng 1 transaction (Repeatable Read / Serializable), dữ liệu bị “đóng băng” theo snapshot tại lúc bắt đầu transaction.<br>Khi mở transaction mới, snapshot mới sẽ được tạo → query sẽ thấy bản ghi mới commit từ transaction khác.</p></blockquote><hr><h3 id=-4-serializable>🧱 4. Serializable<a hidden class=anchor aria-hidden=true href=#-4-serializable>#</a></h3><p>Mức mạnh nhất — đảm bảo kết quả tương đương như thể các transaction chạy <strong>tuần tự</strong>.<br>Ngăn tất cả anomaly (dirty, non-repeatable, phantom).</p><p>Database sẽ phát hiện conflict và <strong>rollback 1 transaction</strong> (serialization failure).</p><p><strong>Ví dụ:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sql data-lang=sql><span style=display:flex><span><span style=color:#75715e>-- Transaction A
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>SUM</span>(balance) <span style=color:#66d9ef>FROM</span> accounts;  <span style=color:#75715e>-- thấy tổng = 1000
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Transaction B
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>UPDATE</span> accounts <span style=color:#66d9ef>SET</span> balance <span style=color:#f92672>=</span> balance <span style=color:#f92672>-</span> <span style=color:#ae81ff>100</span> <span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>COMMIT</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>-- Transaction A (tiếp tục)
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>UPDATE</span> accounts <span style=color:#66d9ef>SET</span> balance <span style=color:#f92672>=</span> balance <span style=color:#f92672>+</span> <span style=color:#ae81ff>100</span> <span style=color:#66d9ef>WHERE</span> id <span style=color:#f92672>=</span> <span style=color:#ae81ff>2</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>COMMIT</span>;
</span></span></code></pre></div><p>Nếu để nguyên <strong>(Read Committed / Repeatable Read)</strong>, về mặt lý thuyết có thể <strong>tổng số dư bị sai lệch</strong>.</p><p>Với <strong>Serializable</strong>, PostgreSQL sẽ <strong>rollback một trong hai transaction</strong> → đảm bảo kết quả <strong>giống như thể chúng chạy tuần tự</strong> <em>(A trước B hoặc B trước A)</em>.</p><hr><h3 id=-ứng-dụng-thực-tế-đặt-vé--booking>🧾 Ứng dụng thực tế: Đặt vé / Booking<a hidden class=anchor aria-hidden=true href=#-ứng-dụng-thực-tế-đặt-vé--booking>#</a></h3><p>Giả sử có <strong>1 ghế duy nhất</strong>.</p><ul><li>Transaction A kiểm tra ghế trống → insert booking.</li><li>Transaction B cũng kiểm tra và thấy trống (do snapshot giống nhau) → insert booking.</li></ul><p>→ Với <strong>Read Committed / Repeatable Read</strong>, có thể 2 booking cùng tồn tại.<br>→ Với <strong>Serializable</strong>, PostgreSQL rollback 1 booking → đảm bảo ghế chỉ được đặt 1 lần.</p><hr><h2 id=-isolation-trong-mongodb>🍃 Isolation trong MongoDB<a hidden class=anchor aria-hidden=true href=#-isolation-trong-mongodb>#</a></h2><p>MongoDB <strong>không có nhiều isolation level như SQL</strong>.<br>Nó chỉ có <strong>một mức duy nhất</strong> cho transaction: <strong>Snapshot Isolation (SI)</strong> — tương tự <strong>Repeatable Read</strong> trong PostgreSQL.</p><p>Nghĩa là:</p><ul><li>Transaction đọc dữ liệu nhất quán theo snapshot tại thời điểm bắt đầu.</li><li>Không thấy dữ liệu chưa commit từ transaction khác (<strong>no dirty read</strong>).</li><li>Các query trong cùng transaction thấy cùng một snapshot (<strong>no non-repeatable read</strong>).</li><li>Tuy nhiên, vẫn có thể gặp <strong>write conflict (phantom/write skew)</strong> → MongoDB sẽ rollback 1 transaction.</li></ul><hr><h2 id=-kết-luận>✅ Kết luận<a hidden class=anchor aria-hidden=true href=#-kết-luận>#</a></h2><p>Việc lựa chọn <strong>isolation level</strong> cho transaction phụ thuộc vào mục đích và yêu cầu của hệ thống.
Ở mức càng cao, ứng dụng sẽ an toàn và nhất quán hơn, nhưng đồng thời hiệu năng có thể giảm do tốn thêm chi phí kiểm tra và khóa dữ liệu.</p><p>Cảm ơn bạn đã đọc đến đây!
Nếu bạn có kinh nghiệm hoặc góc nhìn khác về chủ đề này, đừng ngần ngại chia sẻ ở phần bình luận bên dưới nhé.</p><p>See ya 👋</p><hr></div><footer class=post-footer><ul class=post-tags><li><a href=https://thanhhv.github.io/tags/database/>Database</a></li><li><a href=https://thanhhv.github.io/tags/transaction-isolation/>Transaction Isolation</a></li></ul><nav class=paginav><a class=next href=https://thanhhv.github.io/posts/index-mongodb/><span class=title>Next »</span><br><span>Những điều mình học được về Index trong MongoDB</span></a></nav><ul class=share-buttons><li><a target=_blank rel="noopener noreferrer" aria-label="share Các level isolation của transaction trong SQL on x" href="https://x.com/intent/tweet/?text=C%c3%a1c%20level%20isolation%20c%e1%bb%a7a%20transaction%20trong%20SQL&amp;url=https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f&amp;hashtags=database%2ctransactionisolation"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446C483.971.0 512 28.03 512 62.554zM269.951 190.75 182.567 75.216H56L207.216 272.95 63.9 436.783h61.366L235.9 310.383l96.667 126.4H456L298.367 228.367l134-153.151H371.033zM127.633 110h36.468l219.38 290.065H349.5z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các level isolation của transaction trong SQL on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f&amp;title=C%c3%a1c%20level%20isolation%20c%e1%bb%a7a%20transaction%20trong%20SQL&amp;summary=C%c3%a1c%20level%20isolation%20c%e1%bb%a7a%20transaction%20trong%20SQL&amp;source=https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các level isolation của transaction trong SQL on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f&title=C%c3%a1c%20level%20isolation%20c%e1%bb%a7a%20transaction%20trong%20SQL"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các level isolation của transaction trong SQL on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các level isolation của transaction trong SQL on whatsapp" href="https://api.whatsapp.com/send?text=C%c3%a1c%20level%20isolation%20c%e1%bb%a7a%20transaction%20trong%20SQL%20-%20https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các level isolation của transaction trong SQL on telegram" href="https://telegram.me/share/url?text=C%c3%a1c%20level%20isolation%20c%e1%bb%a7a%20transaction%20trong%20SQL&amp;url=https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></li><li><a target=_blank rel="noopener noreferrer" aria-label="share Các level isolation của transaction trong SQL on ycombinator" href="https://news.ycombinator.com/submitlink?t=C%c3%a1c%20level%20isolation%20c%e1%bb%a7a%20transaction%20trong%20SQL&u=https%3a%2f%2fthanhhv.github.io%2fposts%2ftransaction-isolation-level%2f"><svg width="30" height="30" viewBox="0 0 512 512" fill="currentcolor" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"><path d="M449.446.0C483.971.0 512 28.03 512 62.554V449.446C512 483.97 483.97 512 449.446 512H62.554C28.03 512 0 483.97.0 449.446V62.554C0 28.03 28.029.0 62.554.0H449.446zM183.8767 87.9921h-62.034L230.6673 292.4508V424.0079h50.6655V292.4508L390.1575 87.9921H328.1233L256 238.2489z"/></svg></a></li></ul></footer><script src=https://utteranc.es/client.js repo=thanhhv/blog-comments issue-term=pathname label="💬 comment" theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://thanhhv.github.io/>Thanh HV's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>